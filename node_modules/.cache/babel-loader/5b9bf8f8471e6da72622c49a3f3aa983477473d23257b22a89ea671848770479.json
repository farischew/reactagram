{"ast":null,"code":"import { firebase, FieldValue } from \"../lib/firebase\";\nexport async function doesUsernameExist(userName) {\n  const result = await firebase.firestore().collection(\"users\").where(\"username\", \"==\", userName).get();\n  return result.docs.map(user => user.data().length > 0);\n}\nexport async function getUserByUsername(userName) {\n  const result = await firebase.firestore().collection(\"users\").where(\"username\", \"==\", userName).get();\n  const user = result.dics.map(item => ({\n    ...item.data(),\n    docId: item.id\n  }));\n  return user.length > 0 ? user : false;\n}\nexport async function getUserByUserId(userId) {\n  const result = await firebase.firestore().collection(\"users\").where(\"userId\", \"==\", userId).get();\n  const user = result.docs.map(item => ({\n    ...item.data(),\n    docId: item.id\n  }));\n  return user;\n}\nexport async function getUsersNotFollowed(userId, following) {\n  const result = await firebase.firestore().collection(\"users\").limit(10).get();\n  const output = result.docs.map(user => ({\n    ...user.data(),\n    docId: user.id\n  })).filter(profile => profile.userId !== userId && !following.includes(profile.userId)).filter(profile => profile.userId !== userId && !following.includes(profile.userId));\n  return output;\n}\nexport async function updateLoggedInUserFollowing(loggedInUserDocId, profileId, isFollowingProfile) {\n  return firebase.firestore().collection(\"users\").doc(loggedInUserDocId).update({\n    following: isFollowingProfile ? FieldValue.arrayRemove(profileId) : FieldValue.arrayUnion(profileId)\n  });\n}\nexport async function updateFollowedUserFollowers(spDocId, userId, isFollowingProfile) {\n  return firebase.firestore().collection(\"users\").doc(spDocId).update({\n    followers: isFollowingProfile ? FieldValue.arrayRemove(userId) : FieldValue.arrayUnion(userId)\n  });\n}\nexport async function getPhotos(userId, following) {\n  const result = await firebase.firestore().collection(\"photos\").where(\"userId\", \"in\", following).get();\n  const userFollowedPhotos = result.docs.map(photo => ({\n    ...photo.data(),\n    docId: photo.id\n  }));\n  const photosWithUserDetails = await Promise.all(userFollowedPhotos.map(async photo => {\n    let userLikedPhoto = false;\n    if (photo.likes.includes(userId)) {\n      userLikedPhoto = true;\n    }\n    const user = await getUserByUserId(photo.userId);\n    const {\n      username\n    } = user[0];\n    return {\n      username,\n      ...photo,\n      userLikedPhoto\n    };\n  }));\n  return photosWithUserDetails;\n}","map":{"version":3,"names":["firebase","FieldValue","doesUsernameExist","userName","result","firestore","collection","where","get","docs","map","user","data","length","getUserByUsername","dics","item","docId","id","getUserByUserId","userId","getUsersNotFollowed","following","limit","output","filter","profile","includes","updateLoggedInUserFollowing","loggedInUserDocId","profileId","isFollowingProfile","doc","update","arrayRemove","arrayUnion","updateFollowedUserFollowers","spDocId","followers","getPhotos","userFollowedPhotos","photo","photosWithUserDetails","Promise","all","userLikedPhoto","likes","username"],"sources":["/Users/admin/Desktop/Projects/reactagram/src/services/firebase.js"],"sourcesContent":["import { firebase, FieldValue } from \"../lib/firebase\";\n\nexport async function doesUsernameExist(userName) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", userName)\n    .get();\n\n  return result.docs.map((user) => user.data().length > 0);\n}\n\nexport async function getUserByUsername(userName) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", userName)\n    .get();\n\n  const user = result.dics.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n\n  return user.length > 0 ? user : false;\n}\n\nexport async function getUserByUserId(userId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"userId\", \"==\", userId)\n    .get();\n\n  const user = result.docs.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n\n  return user;\n}\n\nexport async function getUsersNotFollowed(userId, following) {\n  const result = await firebase.firestore().collection(\"users\").limit(10).get();\n\n  const output = result.docs\n    .map((user) => ({ ...user.data(), docId: user.id }))\n    .filter(\n      (profile) =>\n        profile.userId !== userId && !following.includes(profile.userId)\n    )\n    .filter(\n      (profile) =>\n        profile.userId !== userId && !following.includes(profile.userId)\n    );\n\n  return output;\n}\n\nexport async function updateLoggedInUserFollowing(\n  loggedInUserDocId,\n  profileId,\n  isFollowingProfile\n) {\n  return firebase\n    .firestore()\n    .collection(\"users\")\n    .doc(loggedInUserDocId)\n    .update({\n      following: isFollowingProfile\n        ? FieldValue.arrayRemove(profileId)\n        : FieldValue.arrayUnion(profileId),\n    });\n}\n\nexport async function updateFollowedUserFollowers(\n  spDocId,\n  userId,\n  isFollowingProfile\n) {\n  return firebase\n    .firestore()\n    .collection(\"users\")\n    .doc(spDocId)\n    .update({\n      followers: isFollowingProfile\n        ? FieldValue.arrayRemove(userId)\n        : FieldValue.arrayUnion(userId),\n    });\n}\n\nexport async function getPhotos(userId, following) {\n  const result = await firebase\n    .firestore()\n    .collection(\"photos\")\n    .where(\"userId\", \"in\", following)\n    .get();\n\n  const userFollowedPhotos = result.docs.map((photo) => ({\n    ...photo.data(),\n    docId: photo.id,\n  }));\n\n  const photosWithUserDetails = await Promise.all(\n    userFollowedPhotos.map(async (photo) => {\n      let userLikedPhoto = false;\n      if (photo.likes.includes(userId)) {\n        userLikedPhoto = true;\n      }\n      const user = await getUserByUserId(photo.userId);\n      const { username } = user[0];\n      return { username, ...photo, userLikedPhoto };\n    })\n  );\n\n  return photosWithUserDetails;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}