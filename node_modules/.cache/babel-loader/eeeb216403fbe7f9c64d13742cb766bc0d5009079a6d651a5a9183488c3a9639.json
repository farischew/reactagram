{"ast":null,"code":"import { firebase, FieldValue } from \"../lib/firebase\";\nexport async function doesUsernameExist(userName) {\n  const result = await firebase.firestore().collection(\"users\").where(\"username\", \"==\", userName).get();\n  return result.docs.map(user => user.data().length > 0);\n}\nexport async function getUserByUsername(userName) {\n  const result = await firebase.firestore().collection(\"users\").where(\"username\", \"==\", userName).get();\n  return result.docs.map(item => ({\n    ...item.data(),\n    docId: item.id\n  }));\n}\nexport async function getUserByUserId(userId) {\n  const result = await firebase.firestore().collection(\"users\").where(\"userId\", \"==\", userId).get();\n  const user = result.docs.map(item => ({\n    ...item.data(),\n    docId: item.id\n  }));\n  return user;\n}\nexport async function getUsersNotFollowed(userId, following) {\n  const result = await firebase.firestore().collection(\"users\").limit(10).get();\n  const output = result.docs.map(user => ({\n    ...user.data(),\n    docId: user.id\n  })).filter(profile => profile.userId !== userId && !following.includes(profile.userId)).filter(profile => profile.userId !== userId && !following.includes(profile.userId));\n  return output;\n}\nexport async function updateLoggedInUserFollowing(loggedInUserDocId, profileId, isFollowingProfile) {\n  return firebase.firestore().collection(\"users\").doc(loggedInUserDocId).update({\n    following: isFollowingProfile ? FieldValue.arrayRemove(profileId) : FieldValue.arrayUnion(profileId)\n  });\n}\nexport async function updateFollowedUserFollowers(spDocId, userId, isFollowingProfile) {\n  return firebase.firestore().collection(\"users\").doc(spDocId).update({\n    followers: isFollowingProfile ? FieldValue.arrayRemove(userId) : FieldValue.arrayUnion(userId)\n  });\n}\nexport async function getPhotos(userId, following) {\n  const result = await firebase.firestore().collection(\"photos\").where(\"userId\", \"in\", following).get();\n  const userFollowedPhotos = result.docs.map(photo => ({\n    ...photo.data(),\n    docId: photo.id\n  }));\n  const photosWithUserDetails = await Promise.all(userFollowedPhotos.map(async photo => {\n    let userLikedPhoto = false;\n    if (photo.likes.includes(userId)) {\n      userLikedPhoto = true;\n    }\n    const user = await getUserByUserId(photo.userId);\n    const {\n      username\n    } = user[0];\n    return {\n      username,\n      ...photo,\n      userLikedPhoto\n    };\n  }));\n  return photosWithUserDetails;\n}\nexport async function getUserPhotosByUserId(userId) {\n  const result = await firebase.firestore().collection(\"photos\").where(\"userId\", \"==\", userId).get();\n  const photos = result.docs.map(photo => ({\n    ...photo.data(),\n    docId: photo.id\n  }));\n  return photos;\n}\nexport async function isLoggedInUserFollowingProfile(loggedInUserUsername, profileUserId) {\n  const result = await firebase.firestore().collection(\"users\").where(\"username\", \"==\", loggedInUserUsername).where(\"following\", \"array-contains\", profileUserId).get();\n  const [response = {}] = result.docs.map(item => ({\n    ...item.data(),\n    docId: item.id\n  }));\n  console.log(response);\n}","map":{"version":3,"names":["firebase","FieldValue","doesUsernameExist","userName","result","firestore","collection","where","get","docs","map","user","data","length","getUserByUsername","item","docId","id","getUserByUserId","userId","getUsersNotFollowed","following","limit","output","filter","profile","includes","updateLoggedInUserFollowing","loggedInUserDocId","profileId","isFollowingProfile","doc","update","arrayRemove","arrayUnion","updateFollowedUserFollowers","spDocId","followers","getPhotos","userFollowedPhotos","photo","photosWithUserDetails","Promise","all","userLikedPhoto","likes","username","getUserPhotosByUserId","photos","isLoggedInUserFollowingProfile","loggedInUserUsername","profileUserId","response","console","log"],"sources":["/Users/admin/Desktop/Projects/reactagram/src/services/firebase.js"],"sourcesContent":["import { firebase, FieldValue } from \"../lib/firebase\";\n\nexport async function doesUsernameExist(userName) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", userName)\n    .get();\n\n  return result.docs.map((user) => user.data().length > 0);\n}\n\nexport async function getUserByUsername(userName) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", userName)\n    .get();\n\n  return result.docs.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n}\n\nexport async function getUserByUserId(userId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"userId\", \"==\", userId)\n    .get();\n\n  const user = result.docs.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n\n  return user;\n}\n\nexport async function getUsersNotFollowed(userId, following) {\n  const result = await firebase.firestore().collection(\"users\").limit(10).get();\n\n  const output = result.docs\n    .map((user) => ({ ...user.data(), docId: user.id }))\n    .filter(\n      (profile) =>\n        profile.userId !== userId && !following.includes(profile.userId)\n    )\n    .filter(\n      (profile) =>\n        profile.userId !== userId && !following.includes(profile.userId)\n    );\n\n  return output;\n}\n\nexport async function updateLoggedInUserFollowing(\n  loggedInUserDocId,\n  profileId,\n  isFollowingProfile\n) {\n  return firebase\n    .firestore()\n    .collection(\"users\")\n    .doc(loggedInUserDocId)\n    .update({\n      following: isFollowingProfile\n        ? FieldValue.arrayRemove(profileId)\n        : FieldValue.arrayUnion(profileId),\n    });\n}\n\nexport async function updateFollowedUserFollowers(\n  spDocId,\n  userId,\n  isFollowingProfile\n) {\n  return firebase\n    .firestore()\n    .collection(\"users\")\n    .doc(spDocId)\n    .update({\n      followers: isFollowingProfile\n        ? FieldValue.arrayRemove(userId)\n        : FieldValue.arrayUnion(userId),\n    });\n}\n\nexport async function getPhotos(userId, following) {\n  const result = await firebase\n    .firestore()\n    .collection(\"photos\")\n    .where(\"userId\", \"in\", following)\n    .get();\n\n  const userFollowedPhotos = result.docs.map((photo) => ({\n    ...photo.data(),\n    docId: photo.id,\n  }));\n\n  const photosWithUserDetails = await Promise.all(\n    userFollowedPhotos.map(async (photo) => {\n      let userLikedPhoto = false;\n      if (photo.likes.includes(userId)) {\n        userLikedPhoto = true;\n      }\n      const user = await getUserByUserId(photo.userId);\n      const { username } = user[0];\n      return { username, ...photo, userLikedPhoto };\n    })\n  );\n\n  return photosWithUserDetails;\n}\n\nexport async function getUserPhotosByUserId(userId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"photos\")\n    .where(\"userId\", \"==\", userId)\n    .get();\n\n  const photos = result.docs.map((photo) => ({\n    ...photo.data(),\n    docId: photo.id,\n  }));\n  return photos;\n}\n\nexport async function isLoggedInUserFollowingProfile(\n  loggedInUserUsername,\n  profileUserId\n) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", loggedInUserUsername)\n    .where(\"following\", \"array-contains\", profileUserId)\n    .get();\n\n  const [response = {}] = result.docs.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n\n  console.log(response);\n}\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,UAAU,QAAQ,iBAAiB;AAEtD,OAAO,eAAeC,iBAAiBA,CAACC,QAAQ,EAAE;EAChD,MAAMC,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,OAAO,CAAC,CACnBC,KAAK,CAAC,UAAU,EAAE,IAAI,EAAEJ,QAAQ,CAAC,CACjCK,GAAG,CAAC,CAAC;EAER,OAAOJ,MAAM,CAACK,IAAI,CAACC,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACC,IAAI,CAAC,CAAC,CAACC,MAAM,GAAG,CAAC,CAAC;AAC1D;AAEA,OAAO,eAAeC,iBAAiBA,CAACX,QAAQ,EAAE;EAChD,MAAMC,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,OAAO,CAAC,CACnBC,KAAK,CAAC,UAAU,EAAE,IAAI,EAAEJ,QAAQ,CAAC,CACjCK,GAAG,CAAC,CAAC;EAER,OAAOJ,MAAM,CAACK,IAAI,CAACC,GAAG,CAAEK,IAAI,KAAM;IAChC,GAAGA,IAAI,CAACH,IAAI,CAAC,CAAC;IACdI,KAAK,EAAED,IAAI,CAACE;EACd,CAAC,CAAC,CAAC;AACL;AAEA,OAAO,eAAeC,eAAeA,CAACC,MAAM,EAAE;EAC5C,MAAMf,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,OAAO,CAAC,CACnBC,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAEY,MAAM,CAAC,CAC7BX,GAAG,CAAC,CAAC;EAER,MAAMG,IAAI,GAAGP,MAAM,CAACK,IAAI,CAACC,GAAG,CAAEK,IAAI,KAAM;IACtC,GAAGA,IAAI,CAACH,IAAI,CAAC,CAAC;IACdI,KAAK,EAAED,IAAI,CAACE;EACd,CAAC,CAAC,CAAC;EAEH,OAAON,IAAI;AACb;AAEA,OAAO,eAAeS,mBAAmBA,CAACD,MAAM,EAAEE,SAAS,EAAE;EAC3D,MAAMjB,MAAM,GAAG,MAAMJ,QAAQ,CAACK,SAAS,CAAC,CAAC,CAACC,UAAU,CAAC,OAAO,CAAC,CAACgB,KAAK,CAAC,EAAE,CAAC,CAACd,GAAG,CAAC,CAAC;EAE7E,MAAMe,MAAM,GAAGnB,MAAM,CAACK,IAAI,CACvBC,GAAG,CAAEC,IAAI,KAAM;IAAE,GAAGA,IAAI,CAACC,IAAI,CAAC,CAAC;IAAEI,KAAK,EAAEL,IAAI,CAACM;EAAG,CAAC,CAAC,CAAC,CACnDO,MAAM,CACJC,OAAO,IACNA,OAAO,CAACN,MAAM,KAAKA,MAAM,IAAI,CAACE,SAAS,CAACK,QAAQ,CAACD,OAAO,CAACN,MAAM,CACnE,CAAC,CACAK,MAAM,CACJC,OAAO,IACNA,OAAO,CAACN,MAAM,KAAKA,MAAM,IAAI,CAACE,SAAS,CAACK,QAAQ,CAACD,OAAO,CAACN,MAAM,CACnE,CAAC;EAEH,OAAOI,MAAM;AACf;AAEA,OAAO,eAAeI,2BAA2BA,CAC/CC,iBAAiB,EACjBC,SAAS,EACTC,kBAAkB,EAClB;EACA,OAAO9B,QAAQ,CACZK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,OAAO,CAAC,CACnByB,GAAG,CAACH,iBAAiB,CAAC,CACtBI,MAAM,CAAC;IACNX,SAAS,EAAES,kBAAkB,GACzB7B,UAAU,CAACgC,WAAW,CAACJ,SAAS,CAAC,GACjC5B,UAAU,CAACiC,UAAU,CAACL,SAAS;EACrC,CAAC,CAAC;AACN;AAEA,OAAO,eAAeM,2BAA2BA,CAC/CC,OAAO,EACPjB,MAAM,EACNW,kBAAkB,EAClB;EACA,OAAO9B,QAAQ,CACZK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,OAAO,CAAC,CACnByB,GAAG,CAACK,OAAO,CAAC,CACZJ,MAAM,CAAC;IACNK,SAAS,EAAEP,kBAAkB,GACzB7B,UAAU,CAACgC,WAAW,CAACd,MAAM,CAAC,GAC9BlB,UAAU,CAACiC,UAAU,CAACf,MAAM;EAClC,CAAC,CAAC;AACN;AAEA,OAAO,eAAemB,SAASA,CAACnB,MAAM,EAAEE,SAAS,EAAE;EACjD,MAAMjB,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,QAAQ,CAAC,CACpBC,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAEc,SAAS,CAAC,CAChCb,GAAG,CAAC,CAAC;EAER,MAAM+B,kBAAkB,GAAGnC,MAAM,CAACK,IAAI,CAACC,GAAG,CAAE8B,KAAK,KAAM;IACrD,GAAGA,KAAK,CAAC5B,IAAI,CAAC,CAAC;IACfI,KAAK,EAAEwB,KAAK,CAACvB;EACf,CAAC,CAAC,CAAC;EAEH,MAAMwB,qBAAqB,GAAG,MAAMC,OAAO,CAACC,GAAG,CAC7CJ,kBAAkB,CAAC7B,GAAG,CAAC,MAAO8B,KAAK,IAAK;IACtC,IAAII,cAAc,GAAG,KAAK;IAC1B,IAAIJ,KAAK,CAACK,KAAK,CAACnB,QAAQ,CAACP,MAAM,CAAC,EAAE;MAChCyB,cAAc,GAAG,IAAI;IACvB;IACA,MAAMjC,IAAI,GAAG,MAAMO,eAAe,CAACsB,KAAK,CAACrB,MAAM,CAAC;IAChD,MAAM;MAAE2B;IAAS,CAAC,GAAGnC,IAAI,CAAC,CAAC,CAAC;IAC5B,OAAO;MAAEmC,QAAQ;MAAE,GAAGN,KAAK;MAAEI;IAAe,CAAC;EAC/C,CAAC,CACH,CAAC;EAED,OAAOH,qBAAqB;AAC9B;AAEA,OAAO,eAAeM,qBAAqBA,CAAC5B,MAAM,EAAE;EAClD,MAAMf,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,QAAQ,CAAC,CACpBC,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAEY,MAAM,CAAC,CAC7BX,GAAG,CAAC,CAAC;EAER,MAAMwC,MAAM,GAAG5C,MAAM,CAACK,IAAI,CAACC,GAAG,CAAE8B,KAAK,KAAM;IACzC,GAAGA,KAAK,CAAC5B,IAAI,CAAC,CAAC;IACfI,KAAK,EAAEwB,KAAK,CAACvB;EACf,CAAC,CAAC,CAAC;EACH,OAAO+B,MAAM;AACf;AAEA,OAAO,eAAeC,8BAA8BA,CAClDC,oBAAoB,EACpBC,aAAa,EACb;EACA,MAAM/C,MAAM,GAAG,MAAMJ,QAAQ,CAC1BK,SAAS,CAAC,CAAC,CACXC,UAAU,CAAC,OAAO,CAAC,CACnBC,KAAK,CAAC,UAAU,EAAE,IAAI,EAAE2C,oBAAoB,CAAC,CAC7C3C,KAAK,CAAC,WAAW,EAAE,gBAAgB,EAAE4C,aAAa,CAAC,CACnD3C,GAAG,CAAC,CAAC;EAER,MAAM,CAAC4C,QAAQ,GAAG,CAAC,CAAC,CAAC,GAAGhD,MAAM,CAACK,IAAI,CAACC,GAAG,CAAEK,IAAI,KAAM;IACjD,GAAGA,IAAI,CAACH,IAAI,CAAC,CAAC;IACdI,KAAK,EAAED,IAAI,CAACE;EACd,CAAC,CAAC,CAAC;EAEHoC,OAAO,CAACC,GAAG,CAACF,QAAQ,CAAC;AACvB"},"metadata":{},"sourceType":"module","externalDependencies":[]}